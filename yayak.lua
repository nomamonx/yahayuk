local code = [[bG9jYWwgUmF5ZmllbGQgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9zaXJpdXMubWVudS9yYXlmaWVsZCcpKSgpCgpsb2NhbCBXaW5kb3cgPSBSYXlmaWVsZDpDcmVhdGVXaW5kb3coewogICBOYW1lID0gIlByaXZhdGU6IE1UIFlhaGF5eXVrIiwKICAgTG9hZGluZ1RpdGxlID0gIlRlbGVwb3J0IFN5c3RlbSIsCiAgIExvYWRpbmdTdWJ0aXRsZSA9ICJCeSBBQ09ORyIsCn0pCi0tIFRhYiBJbmZvcm1hc2kKLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIEluZm9UYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCJJbmZvcm1hc2kiLCA2MDM0NTA5OTk0KQpJbmZvVGFiOkNyZWF0ZVNlY3Rpb24oIkluZm9ybWFzaSIpCgpJbmZvVGFiOkNyZWF0ZVBhcmFncmFwaCh7CiAgICBUaXRsZSA9ICJKYW1tb2tvIEJhY2EiLAogICAgQ29udGVudCA9ICJJbmkgYWRhbGFoIHNjcmlwdCB0ZWxlcG9ydCBZYW5nIGt1YnVhdCBhc2FsIGFzYWwgYWt3b2thb3drLiIsCn0pClJheWZpZWxkOk5vdGlmeSh7CiAgIFRpdGxlID0gIlNjcmlwdCBEaW11YXQiLAogICBDb250ZW50ID0gIlRFTEFTTyBiZXJoYXNpbCEhISIsCiAgIER1cmF0aW9uID0gNi41LAogICBJbWFnZSA9IDQ0ODMzNjI0NTgsCn0pCi0tID09PT09PT09PT09PT09PT09PT09PT09PQotLSBUYWIgVGVsZXBvcnQKLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIFRlbGVUYWIgPSBXaW5kb3c6Q3JlYXRlVGFiKCJUZWxlcG9ydCIsIDQ0ODMzNjI0NTgpCgpsb2NhbCB0ZWxlcG9ydFBvaW50cyA9IHsKICAgIFNwYXduID0gQ0ZyYW1lLm5ldygtNDYsIDEwLCAtNSksICAgICAtLSBTZXN1YWlrYW4ga29vcmRpbmF0IHNwYXduIGRpIGdhbWUga2FtdQogICAgQ1AxID0gQ0ZyYW1lLm5ldyg4MiwgMTE4LCAtNTM1KSwKICAgIENQMiA9IENGcmFtZS5uZXcoNTQ1LCA0NTAsIDQ5OCksCiAgICBDUDMgPSBDRnJhbWUubmV3KC0yOTAsIDM4MSwgNDU3KSwKICAgIENQNCA9IENGcmFtZS5uZXcoLTEwMDgsIDU0NiwgMTM1OCksCiAgICBDUDUgPSBDRnJhbWUubmV3KC0xNzc5LCA4MzAsIDg3NCksCiAgICBDUDYgPSBDRnJhbWUubmV3KC0xODk3LCA5MTcsIDE1NDcpLAogICAgQ1A3ID0gQ0ZyYW1lLm5ldygtMjI3MCwgOTk0LCAxODAzKSwKICAgIFB1bmNhayA9IENGcmFtZS5uZXcoLTMwMTcsIDEyMTgsIDExNzcpLAp9CgotLSBUb21ib2wgbWFudWFsIHRlbGVwb3J0IHRldGFwIGFkYSAKVGVsZVRhYjpDcmVhdGVTZWN0aW9uKCJUZWxlcG9ydCBNYW51YWwiKQpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+aqSBTcGF3biIsIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgbG9jYWwgY2hhciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgY2hhci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHRlbGVwb3J0UG9pbnRzLlNwYXduCiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCAxIiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1AxCiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCAyIiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1AyCiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCAzIiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1AzCiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCA0IiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1A0CiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCA1IiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1A1CiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCA2IiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1A2CiAgICBlbmQKZW5kIH0pCgpUZWxlVGFiOkNyZWF0ZUJ1dHRvbih7IE5hbWUgPSAi8J+TjSBUZWxlcG9ydCBDUCA3IiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBjaGFyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICBjaGFyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdGVsZXBvcnRQb2ludHMuQ1A3CiAgICBlbmQKZW5kIH0pCgoKVGVsZVRhYjpDcmVhdGVCdXR0b24oeyBOYW1lID0gIuKbsO+4jyBUZWxlcG9ydCBQdW5jYWsiLCBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgIGxvY2FsIGNoYXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgIGNoYXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB0ZWxlcG9ydFBvaW50cy5QdW5jYWsKICAgIGVuZAplbmQgfSkKCi0tIEZpdHVyIEF1dG8gVGVsZXBvcnQgQ1AxIHNhbXBhaSBQdW5jYWsgKyBSZXNwYXduICsgTG9vcApsb2NhbCBpc0F1dG9UZWxlcG9ydGluZyA9IGZhbHNlCmxvY2FsIGF1dG9UZWxlcG9ydFRhc2sgPSBuaWwKCmxvY2FsIGF1dG9UZWxlcG9ydFBvaW50cyA9IHsKICAgIHRlbGVwb3J0UG9pbnRzLkNQMSwKICAgIHRlbGVwb3J0UG9pbnRzLkNQMiwKICAgIHRlbGVwb3J0UG9pbnRzLkNQMywKICAgIHRlbGVwb3J0UG9pbnRzLkNQNCwKICAgIHRlbGVwb3J0UG9pbnRzLkNQNSwKICAgIHRlbGVwb3J0UG9pbnRzLkNQNiwKICAgIHRlbGVwb3J0UG9pbnRzLkNQNywKICAgIHRlbGVwb3J0UG9pbnRzLlB1bmNhaywKfQoKbG9jYWwgZnVuY3Rpb24gcmVzcGF3bkNoYXJhY3RlcigpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGlmIHBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgIHBsYXllci5DaGFyYWN0ZXI6QnJlYWtKb2ludHMoKQogICAgZW5kCiAgICAtLSBUdW5nZ3Uga2FyYWt0ZXIgcmVzcGF3bgogICAgcmVwZWF0IHRhc2sud2FpdCgpIHVudGlsIHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgcGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5IZWFsdGggPiAwCmVuZAoKbG9jYWwgZnVuY3Rpb24gaXNBdFNwYXduKHBvcywgdGhyZXNob2xkKQogICAgbG9jYWwgc3Bhd25Qb3MgPSB0ZWxlcG9ydFBvaW50cy5TcGF3bi5Qb3NpdGlvbgogICAgcmV0dXJuIChwb3MgLSBzcGF3blBvcykuTWFnbml0dWRlIDw9IHRocmVzaG9sZAplbmQKClRlbGVUYWI6Q3JlYXRlU2VjdGlvbigiVGVsZXBvcnQgT3RvbWF0aXMiKQoKLS0gVG9nZ2xlIEF1dG8gVGVsZXBvcnQKVGVsZVRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn4+GIEF1dG8gVGVsZXBvcnQiLAogICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgICBGbGFnID0gIkF1dG9UZWxlcG9ydFRvZ2dsZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGlzQXV0b1RlbGVwb3J0aW5nID0gVmFsdWUKCiAgICAgICAgaWYgaXNBdXRvVGVsZXBvcnRpbmcgdGhlbgogICAgICAgICAgICAtLSBTdGFydCBBdXRvIFRlbGVwb3J0CiAgICAgICAgICAgIGF1dG9UZWxlcG9ydFRhc2sgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGlzQXV0b1RlbGVwb3J0aW5nIGRvCiAgICAgICAgICAgICAgICAgICAgZm9yIGksIGNmIGluIGlwYWlycyhhdXRvVGVsZXBvcnRQb2ludHMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc0F1dG9UZWxlcG9ydGluZyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IGNmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gVGVsZXBvcnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiVGVsZXBvcnQga2UgQ1AgIi4uaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDIpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc0F1dG9UZWxlcG9ydGluZyB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIlJlc3Bhd24iLAogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIlJlc3Bhd24ga2FyYWt0ZXIuLi4iLAogICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIsCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICByZXNwYXduQ2hhcmFjdGVyKCkKCiAgICAgICAgICAgICAgICAgICAgLS0gVHVuZ2d1IHNhbXBhaSBrYXJha3RlciBiZW5hci1iZW5hciBiZXJhZGEgZGkgc3Bhd24KICAgICAgICAgICAgICAgICAgICBsb2NhbCBtYXhXYWl0VGltZSA9IDYKICAgICAgICAgICAgICAgICAgICBsb2NhbCB3YWl0ZWQgPSAwCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRlZCArPSAwLjUKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlzQXRTcGF3bihjaGFyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24sIDEwKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB1bnRpbCB3YWl0ZWQgPj0gbWF4V2FpdFRpbWUKCiAgICAgICAgICAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiTG9vcCBVbGFuZyIsCiAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiTXVsYWkgbGFnaSBkYXJpIENQMS4uLiIsCiAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMiwKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMS41KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIC0tIFN0b3AgQXV0byBUZWxlcG9ydAogICAgICAgICAgICBpZiBhdXRvVGVsZXBvcnRUYXNrIHRoZW4KICAgICAgICAgICAgICAgIHRhc2suY2FuY2VsKGF1dG9UZWxlcG9ydFRhc2spCiAgICAgICAgICAgICAgICBhdXRvVGVsZXBvcnRUYXNrID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBUZWxlcG9ydCIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gdGVsZXBvcnQgZGloZW50aWthbiEiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzLAogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kLAp9KQoKCgotLSBEZXRlY3Rpb24gVGFiCi0tID09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgRGV0ZWN0aW9uVGFiID0gV2luZG93OkNyZWF0ZVRhYigiRGV0ZWN0aW9uIiwgNDQ4MzM2MjQ1OCkKRGV0ZWN0aW9uVGFiOkNyZWF0ZVNlY3Rpb24oIkRldGVrc2kiKQotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KLS0gSGVscGVyIEZ1bmN0aW9ucwotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KbG9jYWwgZnVuY3Rpb24gR2V0UGxheWVyU3VtbWl0KHBsYXllcikKICAgIGxvY2FsIHN1bW1pdE51bWJlciA9IG5pbAogICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhcmFjdGVyIHRoZW4KICAgICAgICBsb2NhbCBoZWFkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikKICAgICAgICBpZiBoZWFkIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGd1aSBpbiBpcGFpcnMoaGVhZDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgZ3VpOklzQSgiQmlsbGJvYXJkR3VpIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCBsYWJlbCBpbiBpcGFpcnMoZ3VpOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhYmVsOklzQSgiVGV4dExhYmVsIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3VtbWl0VGV4dCA9IHN0cmluZy5tYXRjaChsYWJlbC5UZXh0LCAiW1NzXXVtbWl0W14lZF0qKFslZCwlLl0rKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBzdW1taXRUZXh0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdW1taXRUZXh0ID0gc3VtbWl0VGV4dDpnc3ViKCJbLCUuXSIsICIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1bW1pdE51bWJlciA9IHRvbnVtYmVyKHN1bW1pdFRleHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGlmIG5vdCBzdW1taXROdW1iZXIgdGhlbgogICAgICAgIGxvY2FsIHN0YXRzID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJsZWFkZXJzdGF0cyIpCiAgICAgICAgaWYgc3RhdHMgdGhlbgogICAgICAgICAgICBsb2NhbCBzdW1taXRTdGF0ID0gc3RhdHM6RmluZEZpcnN0Q2hpbGQoIlN1bW1pdCIpIG9yIHN0YXRzOkZpbmRGaXJzdENoaWxkKCJTdW1taXRzIikKICAgICAgICAgICAgaWYgc3VtbWl0U3RhdCBhbmQgdG9udW1iZXIoc3VtbWl0U3RhdC5WYWx1ZSkgdGhlbgogICAgICAgICAgICAgICAgc3VtbWl0TnVtYmVyID0gdG9udW1iZXIoc3VtbWl0U3RhdC5WYWx1ZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBzdW1taXROdW1iZXIgb3IgMAplbmQKCmxvY2FsIGZ1bmN0aW9uIERldGVjdEFkbWlucygpCiAgICBsb2NhbCBhZG1pbnMgPSB7fQogICAgZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIGNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgIGxvY2FsIGhlYWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKQogICAgICAgICAgICBpZiBoZWFkIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCBndWkgaW4gaXBhaXJzKGhlYWQ6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBndWk6SXNBKCJCaWxsYm9hcmRHdWkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBsYWJlbCBpbiBpcGFpcnMoZ3VpOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBsYWJlbDpJc0EoIlRleHRMYWJlbCIpIGFuZCBzdHJpbmcuZmluZChzdHJpbmcudXBwZXIobGFiZWwuVGV4dCksICJBRE1JTiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoYWRtaW5zLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWUgPSBwbGF5ZXIuTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3VtbWl0ID0gR2V0UGxheWVyU3VtbWl0KHBsYXllcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBhZG1pbnMKZW5kCgpsb2NhbCBmdW5jdGlvbiBEZXRlY3RUb3BTdW1taXRzKGxpbWl0KQogICAgbG9jYWwgcmVzdWx0cyA9IHt9CiAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBsb2NhbCBzdW1taXROdW1iZXIgPSBHZXRQbGF5ZXJTdW1taXQocGxheWVyKQogICAgICAgIGlmIHN1bW1pdE51bWJlciB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydChyZXN1bHRzLCB7TmFtZSA9IHBsYXllci5OYW1lLCBTdW1taXQgPSBzdW1taXROdW1iZXJ9KQogICAgICAgIGVuZAogICAgZW5kCiAgICB0YWJsZS5zb3J0KHJlc3VsdHMsIGZ1bmN0aW9uKGEsIGIpIHJldHVybiBhLlN1bW1pdCA+IGIuU3VtbWl0IGVuZCkKICAgIGxvY2FsIHRvcE4gPSB7fQogICAgZm9yIGkgPSAxLCBtYXRoLm1pbihsaW1pdCwgI3Jlc3VsdHMpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KHRvcE4sIHJlc3VsdHNbaV0pCiAgICBlbmQKICAgIHJldHVybiB0b3BOCmVuZAoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09Ci0tIEFkbWluIERldGVjdGlvbgotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KbG9jYWwgQWRtaW5Mb29wCmxvY2FsIEFkbWluTGFiZWwKCkRldGVjdGlvblRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn5SNIENoZWNrIEFkbWlucyIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiQ2hlY2tBZG1pbnNUb2dnbGUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEFkbWluTG9vcCA9IHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgbGFzdEFkbWlucyA9ICIiCiAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYWRtaW5zID0gRGV0ZWN0QWRtaW5zKCkKICAgICAgICAgICAgICAgICAgICBpZiAjYWRtaW5zID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxhYmVsVGV4dCA9ICJBZG1pbiBUZXJkZXRla3NpICgiLi4jYWRtaW5zLi4iKToiCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG5vdGlmeVRleHQgPSBsYWJlbFRleHQKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGRhdGEgaW4gaXBhaXJzKGFkbWlucykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsVGV4dCA9IGxhYmVsVGV4dCAuLiAiXG4tICIgLi4gZGF0YS5OYW1lIC4uICIgKFN1bW1pdDogIiAuLiBkYXRhLlN1bW1pdCAuLiAiKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeVRleHQgPSBub3RpZnlUZXh0IC4uICJcbi0gIiAuLiBkYXRhLk5hbWUgLi4gIiAoU3VtbWl0OiAiIC4uIGRhdGEuU3VtbWl0IC4uICIpIgogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgQWRtaW5MYWJlbCB0aGVuIEFkbWluTGFiZWw6U2V0KGxhYmVsVGV4dCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdGlmeVRleHQgfj0gbGFzdEFkbWlucyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkFkbWluIFRlcmRldGVrc2khIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gbm90aWZ5VGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEFkbWlucyA9IG5vdGlmeVRleHQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBBZG1pbkxhYmVsIHRoZW4gQWRtaW5MYWJlbDpTZXQoIkFkbWluIFRlcmRldGVrc2k6IC0iKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEFkbWlucyA9ICIiCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgQWRtaW5Mb29wIHRoZW4KICAgICAgICAgICAgICAgIHRhc2suY2FuY2VsKEFkbWluTG9vcCkKICAgICAgICAgICAgICAgIEFkbWluTG9vcCA9IG5pbAogICAgICAgICAgICAgICAgaWYgQWRtaW5MYWJlbCB0aGVuIEFkbWluTGFiZWw6U2V0KCJBZG1pbiBUZXJkZXRla3NpOiAtIikgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kLAp9KQoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09Ci0tIFN1bW1pdCBEZXRlY3Rpb24KLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIFN1bW1pdExvb3AKbG9jYWwgU3VtbWl0TGFiZWwKCkRldGVjdGlvblRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn5SNIENoZWNrIFBybyIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiQ2hlY2tTdW1taXRUb2dnbGUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIFN1bW1pdExvb3AgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIGxhc3RUb3AgPSAiIgogICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRvcDMgPSBEZXRlY3RUb3BTdW1taXRzKDMpCiAgICAgICAgICAgICAgICAgICAgaWYgI3RvcDMgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbGFiZWxUZXh0ID0gIlRvcCBQdW5jYWs6IgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBub3RpZnlUZXh0ID0gIiIKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIGRhdGEgaW4gaXBhaXJzKHRvcDMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFRleHQgPSBsYWJlbFRleHQgLi4gIlxuIiAuLiBpIC4uICIpICIgLi4gZGF0YS5OYW1lIC4uICIgKCIgLi4gZGF0YS5TdW1taXQgLi4gIikiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZnlUZXh0ID0gbm90aWZ5VGV4dCAuLiAiXG4iIC4uIGkgLi4gIikgIiAuLiBkYXRhLk5hbWUgLi4gIiAoIiAuLiBkYXRhLlN1bW1pdCAuLiAiKSIKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFN1bW1pdExhYmVsIHRoZW4gU3VtbWl0TGFiZWw6U2V0KGxhYmVsVGV4dCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdGlmeVRleHQgfj0gbGFzdFRvcCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIlB1bmNhayBUb3AgMyEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSBub3RpZnlUZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0VG9wID0gbm90aWZ5VGV4dAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFN1bW1pdExhYmVsIHRoZW4gU3VtbWl0TGFiZWw6U2V0KCJUb3AgUHVuY2FrOiAtIikgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RUb3AgPSAiIgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCg1KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIFN1bW1pdExvb3AgdGhlbgogICAgICAgICAgICAgICAgdGFzay5jYW5jZWwoU3VtbWl0TG9vcCkKICAgICAgICAgICAgICAgIFN1bW1pdExvb3AgPSBuaWwKICAgICAgICAgICAgICAgIGlmIFN1bW1pdExhYmVsIHRoZW4gU3VtbWl0TGFiZWw6U2V0KCJUb3AgUHVuY2FrOiAtIikgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kLAp9KQoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09Ci0tIExhYmVsIGRpIHBhbGluZyBiYXdhaAotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KQWRtaW5MYWJlbCA9IERldGVjdGlvblRhYjpDcmVhdGVMYWJlbCgiQWRtaW4gVGVyZGV0ZWtzaTogLSIpClN1bW1pdExhYmVsID0gRGV0ZWN0aW9uVGFiOkNyZWF0ZUxhYmVsKCJUb3AgUHVuY2FrOiAtIikKCkRldGVjdGlvblRhYjpDcmVhdGVTZWN0aW9uKCJGaXR1ciBMYWlubnlhIikKCi0tID09PT09PT09PT09PT09PT09PT09PT09PQotLSBBdXRvIExlYXZlIEppa2EgQWRtaW4KLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIEF1dG9MZWF2ZUxvb3AKCkRldGVjdGlvblRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn5qqIEF1dG8gTGVhdmUgSmlrYSBBZG1pbiIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiQXV0b0xlYXZlQWRtaW5Ub2dnbGUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEF1dG9MZWF2ZUxvb3AgPSB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBhZG1pbnMgPSBEZXRlY3RBZG1pbnMoKQogICAgICAgICAgICAgICAgICAgIGlmICNhZG1pbnMgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgLS0gTm90aWYgZHVsdSBiaWFyIGplbGFzCiAgICAgICAgICAgICAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJLZWx1YXIgU2VydmVyISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIkFkbWluIHRlcmRldGVrc2ksIGtlbHVhciBvdG9tYXRpcy4uLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXI6S2ljaygiQWRtaW4gdGVyZGV0ZWtzaSBkaSBzZXJ2ZXIuIEthbXUgb3RvbWF0aXMga2VsdWFyLiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgQXV0b0xlYXZlTG9vcCB0aGVuCiAgICAgICAgICAgICAgICB0YXNrLmNhbmNlbChBdXRvTGVhdmVMb29wKQogICAgICAgICAgICAgICAgQXV0b0xlYXZlTG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCwKfSkKbG9jYWwgQXV0b05vdGlmeUxvb3AKCkRldGVjdGlvblRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn5OkIE5vdGlmIEFkbWluIE1hc3VrIiwKICAgIEN1cnJlbnRWYWx1ZSA9IGZhbHNlLAogICAgRmxhZyA9ICJOb3RpZnlBZG1pbkpvaW5Ub2dnbGUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIC0tIFBhc2FuZyBsaXN0ZW5lciBQbGF5ZXJBZGRlZAogICAgICAgICAgICBBdXRvTm90aWZ5TG9vcCA9IFBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICAgICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGFyKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgyKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhlYWQgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikKICAgICAgICAgICAgICAgICAgICBpZiBoZWFkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGd1aSBpbiBpcGFpcnMoaGVhZDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ3VpOklzQSgiQmlsbGJvYXJkR3VpIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBsYWJlbCBpbiBpcGFpcnMoZ3VpOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhYmVsOklzQSgiVGV4dExhYmVsIikgYW5kIHN0cmluZy5maW5kKHN0cmluZy51cHBlcihsYWJlbC5UZXh0KSwgIkFETUlOIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICLimqDvuI8gQWRtaW4gTWFzdWshIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gcGxheWVyLk5hbWUgLi4gIiBhZGFsYWggQWRtaW4hIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgQXV0b05vdGlmeUxvb3AgdGhlbgogICAgICAgICAgICAgICAgQXV0b05vdGlmeUxvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBBdXRvTm90aWZ5TG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCwKfSkKCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KLS0gVGFiIFBlbmdhdHVyYW4KLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIFNldHRpbmdzVGFiID0gV2luZG93OkNyZWF0ZVRhYigiU2V0dGluZ3MiLCA2MDM0NTA5OTkzKQoKClNldHRpbmdzVGFiOkNyZWF0ZVNlY3Rpb24oIkZpdHVyIFRhbWJhaGFuIikKLS0gPT09PT09PT09PT09PT09PT09PT09PT09Ci0tIFdhbGxoYWNrIE5hbWEgKyBKYXJhayAoQXV0byBVcGRhdGUpCi0tID09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQoKbG9jYWwgRVNQRW5hYmxlZCA9IGZhbHNlCmxvY2FsIEVTUE9iamVjdHMgPSB7fQoKbG9jYWwgZnVuY3Rpb24gQ3JlYXRlTmFtZUVTUChwbGF5ZXIpCiAgICBpZiBFU1BPYmplY3RzW3BsYXllcl0gdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgYmlsbGJvYXJkID0gSW5zdGFuY2UubmV3KCJCaWxsYm9hcmRHdWkiKQogICAgYmlsbGJvYXJkLk5hbWUgPSAiTmFtZUVTUCIKICAgIGJpbGxib2FyZC5TaXplID0gVURpbTIubmV3KDAsIDE1MCwgMCwgMjUpCiAgICBiaWxsYm9hcmQuQWx3YXlzT25Ub3AgPSB0cnVlCiAgICBiaWxsYm9hcmQuU3R1ZHNPZmZzZXQgPSBWZWN0b3IzLm5ldygwLCAzLCAwKQoKICAgIGxvY2FsIGxhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgbGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgbGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGxhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApCiAgICBsYWJlbC5UZXh0U3Ryb2tlVHJhbnNwYXJlbmN5ID0gMC4yCiAgICBsYWJlbC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnNCb2xkCiAgICBsYWJlbC5UZXh0U2l6ZSA9IDE0CiAgICBsYWJlbC5UZXh0ID0gcGxheWVyLkRpc3BsYXlOYW1lCiAgICBsYWJlbC5QYXJlbnQgPSBiaWxsYm9hcmQKCiAgICBFU1BPYmplY3RzW3BsYXllcl0gPSB7YmlsbGJvYXJkID0gYmlsbGJvYXJkLCBsYWJlbCA9IGxhYmVsfQplbmQKCmxvY2FsIGZ1bmN0aW9uIFJlbW92ZUVTUChwbGF5ZXIpCiAgICBpZiBFU1BPYmplY3RzW3BsYXllcl0gdGhlbgogICAgICAgIGlmIEVTUE9iamVjdHNbcGxheWVyXS5iaWxsYm9hcmQgdGhlbgogICAgICAgICAgICBFU1BPYmplY3RzW3BsYXllcl0uYmlsbGJvYXJkOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIEVTUE9iamVjdHNbcGxheWVyXSA9IG5pbAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gQXR0YWNoQmlsbGJvYXJkKHBsYXllciwgY2hhcikKICAgIGxvY2FsIG9iaiA9IEVTUE9iamVjdHNbcGxheWVyXQogICAgaWYgb2JqIGFuZCBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgdGhlbgogICAgICAgIG9iai5iaWxsYm9hcmQuQWRvcm5lZSA9IGNoYXIuSGVhZAogICAgICAgIG9iai5iaWxsYm9hcmQuUGFyZW50ID0gY2hhci5IZWFkCiAgICBlbmQKZW5kCgotLSBMb29wIHV0YW1hIHVwZGF0ZSBqYXJhayAmIHBhc2FuZyBFU1AKUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgaWYgbm90IEVTUEVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBsb2NhbENoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIGxvY2FsSFJQID0gbG9jYWxDaGFyIGFuZCBsb2NhbENoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIGlmIHBsciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgIC0tIHBhc3Rpa2FuIHNlbGFsdSBhZGEgRVNQCiAgICAgICAgICAgIGlmIG5vdCBFU1BPYmplY3RzW3Bscl0gdGhlbgogICAgICAgICAgICAgICAgQ3JlYXRlTmFtZUVTUChwbHIpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgb2JqID0gRVNQT2JqZWN0c1twbHJdCiAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBwbHIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSB0aGVuCiAgICAgICAgICAgICAgICAtLSByZS1hdHRhY2gga2FsYXUgcGVybHUKICAgICAgICAgICAgICAgIGlmIG9iai5iaWxsYm9hcmQuUGFyZW50IH49IGNoYXIuSGVhZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgQXR0YWNoQmlsbGJvYXJkKHBsciwgY2hhcikKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIC0tIHVwZGF0ZSBqYXJhayByZWFsdGltZQogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICBpZiBsb2NhbEhSUCBhbmQgaHJwIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKGhycC5Qb3NpdGlvbiAtIGxvY2FsSFJQLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBvYmoubGFiZWwuVGV4dCA9IHBsci5EaXNwbGF5TmFtZSAuLiAiIFsiIC4uIG1hdGguZmxvb3IoZGlzdCkgLi4gIm1dIgogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIG9iai5sYWJlbC5UZXh0ID0gcGxyLkRpc3BsYXlOYW1lIC4uICIgW04vQV0iCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gVG9nZ2xlIEVTUApsb2NhbCBmdW5jdGlvbiBUb2dnbGVFU1Aoc3RhdGUpCiAgICBFU1BFbmFibGVkID0gc3RhdGUKICAgIGlmIG5vdCBFU1BFbmFibGVkIHRoZW4KICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKEVTUE9iamVjdHMpIGRvCiAgICAgICAgICAgIGlmIG9iai5iaWxsYm9hcmQgdGhlbiBvYmouYmlsbGJvYXJkOkRlc3Ryb3koKSBlbmQKICAgICAgICBlbmQKICAgICAgICBFU1BPYmplY3RzID0ge30KICAgIGVuZAplbmQKCi0tIFRvZ2dsZSBkaSBTZXR0aW5nc1RhYgpTZXR0aW5nc1RhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICJXYWxsaGFjayIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiRVNQTmFtZURpc3RhbmNlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgVG9nZ2xlRVNQKFZhbHVlKQogICAgZW5kLAp9KQoKIAotLSA9PT09PT09PT09PT09PT09PT09PT09PT09Ci0tIFRBQiBQRU5HQVRVUkFOIChMZW5na2FwKQotLSA9PT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT09Ci0tIERFRkFVTFQgJiBTVEFURQotLSA9PT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIGRlZmF1bHRXYWxrU3BlZWQgPSAxNgpsb2NhbCB3YWxrU3BlZWRFbmFibGVkID0gZmFsc2UgLS0gZGVmYXVsdCBPRkYKbG9jYWwgaW5maW5pdHlKdW1wRW5hYmxlZCA9IGZhbHNlCmxvY2FsIGN1cnJlbnRXYWxrU3BlZWRWYWx1ZSA9IDE2IC0tIHNpbmtyb24gZGVuZ2FuIHNsaWRlcgoKLS0gY2FjaGUgY29ubmVjdGlvbnMgc3VwYXlhIGJpc2EgZGlrZWxvbGEKbG9jYWwgX2lqSnVtcFJlcUNvbm4sIF9paklucHV0QmVnYW5Db25uCgotLSBoZWxwZXI6IGFtYmlsIEh1bWFub2lkIGFtYW4KbG9jYWwgZnVuY3Rpb24gZ2V0SHVtYW5vaWQoKQogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIHJldHVybiBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQplbmQKCi0tIGhlbHBlcjogYXBwbHkgV2Fsa1NwZWVkIHNlc3VhaSB0b2dnbGUgJiBzbGlkZXIKbG9jYWwgZnVuY3Rpb24gYXBwbHlXYWxrU3BlZWQoKQogICAgbG9jYWwgaHVtID0gZ2V0SHVtYW5vaWQoKQogICAgaWYgbm90IGh1bSB0aGVuIHJldHVybiBlbmQKICAgIGlmIHdhbGtTcGVlZEVuYWJsZWQgdGhlbgogICAgICAgIGh1bS5XYWxrU3BlZWQgPSBjdXJyZW50V2Fsa1NwZWVkVmFsdWUKICAgIGVsc2UKICAgICAgICBodW0uV2Fsa1NwZWVkID0gZGVmYXVsdFdhbGtTcGVlZAogICAgZW5kCmVuZAoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQotLSBVSSBTRUNUSU9OCi0tID09PT09PT09PT09PT09PT09PT09PT09PT0KU2V0dGluZ3NUYWI6Q3JlYXRlU2VjdGlvbigiUGVuZ2F0dXJhbiIpCgotLSBXYWxrU3BlZWQgU2xpZGVyCmxvY2FsIFdhbGtTcGVlZFNsaWRlciA9IFNldHRpbmdzVGFiOkNyZWF0ZVNsaWRlcih7CiAgICBOYW1lID0gIldhbGtTcGVlZCIsCiAgICBSYW5nZSA9IHsxNiwgMjAwfSwKICAgIEluY3JlbWVudCA9IDUsCiAgICBTdWZmaXggPSAiU3BlZWQiLAogICAgQ3VycmVudFZhbHVlID0gZGVmYXVsdFdhbGtTcGVlZCwKICAgIEZsYWcgPSAiV2Fsa1NwZWVkU2xpZGVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgY3VycmVudFdhbGtTcGVlZFZhbHVlID0gVmFsdWUKICAgICAgICBpZiB3YWxrU3BlZWRFbmFibGVkIHRoZW4KICAgICAgICAgICAgYXBwbHlXYWxrU3BlZWQoKQogICAgICAgIGVuZAogICAgZW5kLAp9KQoKLS0gV2Fsa1NwZWVkIFRvZ2dsZQpsb2NhbCBXYWxrU3BlZWRUb2dnbGUgPSBTZXR0aW5nc1RhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICJXYWxrU3BlZWQgT24vT2ZmIiwKICAgIEN1cnJlbnRWYWx1ZSA9IHdhbGtTcGVlZEVuYWJsZWQsIC0tIGRlZmF1bHQgZmFsc2UKICAgIEZsYWcgPSAiV2Fsa1NwZWVkVG9nZ2xlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgd2Fsa1NwZWVkRW5hYmxlZCA9IFZhbHVlCiAgICAgICAgYXBwbHlXYWxrU3BlZWQoKQogICAgZW5kLAp9KQoKLS0gUmUtYXBwbHkgc2FhdCByZXNwYXduCkxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgIGNoYXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpCiAgICB0YXNrLmRlZmVyKGFwcGx5V2Fsa1NwZWVkKQplbmQpCgotLSBTZWRpa2l0IOKAnHBlbmphZ2HigJ0ga2FsYXUgZ2FtZSBtZW5jb2JhIGdhbnRpIFdhbGtTcGVlZAp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICB0YXNrLndhaXQoMC4yNSkKICAgICAgICBpZiB3YWxrU3BlZWRFbmFibGVkIHRoZW4KICAgICAgICAgICAgbG9jYWwgaHVtID0gZ2V0SHVtYW5vaWQoKQogICAgICAgICAgICBpZiBodW0gYW5kIGh1bS5XYWxrU3BlZWQgfj0gY3VycmVudFdhbGtTcGVlZFZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGh1bS5XYWxrU3BlZWQgPSBjdXJyZW50V2Fsa1NwZWVkVmFsdWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PQotLSBJTkZJTklUWSBKVU1QCi0tID09PT09PT09PT09PT09PT09PT09PT09PT0KbG9jYWwgZnVuY3Rpb24gZm9yY2VKdW1wKCkKICAgIGxvY2FsIGh1bSA9IGdldEh1bWFub2lkKCkKICAgIGlmIG5vdCBodW0gdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCByb290ID0gaHVtLlBhcmVudCBhbmQgaHVtLlBhcmVudDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgLS0gMSkgc3RhbmRhcmQganVtcCBmbGFnCiAgICBodW0uSnVtcCA9IHRydWUKCiAgICAtLSAyKSBwYWtzYSBzdGF0ZSBrZSBKdW1waW5nCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgaHVtOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuSnVtcGluZykKICAgIGVuZCkKCiAgICAtLSAzKSBmYWxsYmFjazogZG9yb25nIGtlIGF0YXMKICAgIGlmIHJvb3QgdGhlbgogICAgICAgIGxvY2FsIHYgPSByb290LkFzc2VtYmx5TGluZWFyVmVsb2NpdHkKICAgICAgICBsb2NhbCBraWNrWSA9IDUwCiAgICAgICAgcm9vdC5Bc3NlbWJseUxpbmVhclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcodi5YLCBtYXRoLm1heCh2LlksIGtpY2tZKSwgdi5aKQogICAgZW5kCmVuZAoKLS0gYWt0aWZrYW4gbGlzdGVuZXIgSW5maW5pdHkgSnVtcApsb2NhbCBmdW5jdGlvbiBiaW5kSW5maW5pdHlKdW1wQ29ubmVjdGlvbnMoKQogICAgLS0gYmVyc2loa2FuIGtvbmVrc2kgbGFtYQogICAgaWYgX2lqSnVtcFJlcUNvbm4gdGhlbiBfaWpKdW1wUmVxQ29ubjpEaXNjb25uZWN0KCkgZW5kCiAgICBpZiBfaWpJbnB1dEJlZ2FuQ29ubiB0aGVuIF9paklucHV0QmVnYW5Db25uOkRpc2Nvbm5lY3QoKSBlbmQKCiAgICAtLSBFdmVudCB1bml2ZXJzYWwganVtcAogICAgX2lqSnVtcFJlcUNvbm4gPSBVc2VySW5wdXRTZXJ2aWNlLkp1bXBSZXF1ZXN0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIGluZmluaXR5SnVtcEVuYWJsZWQgdGhlbgogICAgICAgICAgICBmb3JjZUp1bXAoKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIC0tIFRhbWJhaGFuIHVudHVrIFNwYWNlIC8gR2FtZXBhZCBBCiAgICBfaWpJbnB1dEJlZ2FuQ29ubiA9IFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBncGUpCiAgICAgICAgaWYgZ3BlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlmIG5vdCBpbmZpbml0eUp1bXBFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBrYyA9IGlucHV0LktleUNvZGUKICAgICAgICBpZiBrYyA9PSBFbnVtLktleUNvZGUuU3BhY2Ugb3Iga2MgPT0gRW51bS5LZXlDb2RlLkJ1dHRvbkEgdGhlbgogICAgICAgICAgICBmb3JjZUp1bXAoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIFRvZ2dsZSBJbmZpbml0eSBKdW1wClNldHRpbmdzVGFiOkNyZWF0ZVRvZ2dsZSh7CiAgICBOYW1lID0gIkluZmluaXR5IEp1bXAiLAogICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgICBGbGFnID0gIkluZmluaXR5SnVtcFRvZ2dsZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGluZmluaXR5SnVtcEVuYWJsZWQgPSBWYWx1ZQogICAgICAgIGlmIG5vdCBfaWpKdW1wUmVxQ29ubiBvciBub3QgX2lqSW5wdXRCZWdhbkNvbm4gdGhlbgogICAgICAgICAgICBiaW5kSW5maW5pdHlKdW1wQ29ubmVjdGlvbnMoKQogICAgICAgIGVuZAogICAgZW5kLAp9KQoKLS0gcGFzdGlrYW4ga29uZWtzaSB0ZXItYmluZCBzYWF0IHNjcmlwdCBsb2FkCmJpbmRJbmZpbml0eUp1bXBDb25uZWN0aW9ucygpCgoKU2V0dGluZ3NUYWI6Q3JlYXRlU2VjdGlvbigiRml0dXIgRmx5IChCZXRhKSIpCi0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tIEZseSBVbml2ZXJzYWwgU3RhYmxlIChQQyAmIE1vYmlsZSkKLS0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgZmx5aW5nID0gZmFsc2UKbG9jYWwgZmx5U3BlZWQgPSA1MApsb2NhbCBmbHlCViwgZmx5R3lybwpsb2NhbCBmbHlDb25uCgotLSBVSSAoTW9iaWxlIEJ1dHRvbnMpCmxvY2FsIFNjcmVlbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKU2NyZWVuR3VpLk5hbWUgPSAiRmx5TW9iaWxlVUkiClNjcmVlbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQpTY3JlZW5HdWkuUGFyZW50ID0gZ2FtZTpHZXRTZXJ2aWNlKCJDb3JlR3VpIikKCmxvY2FsIFVwQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKVXBCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDAsIDUwKQpVcEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjgyLCAwLCAwLjY1LCAwKQpVcEJ1dHRvbi5UZXh0ID0gIuKshiBOYWlrIgpVcEJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTcwLCAyNTUpClVwQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSkKVXBCdXR0b24uVGV4dFNjYWxlZCA9IHRydWUKVXBCdXR0b24uUGFyZW50ID0gU2NyZWVuR3VpClVwQnV0dG9uLlZpc2libGUgPSBmYWxzZQoKbG9jYWwgRG93bkJ1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCkRvd25CdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDAsIDUwKQpEb3duQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuODIsIDAsIDAuNzUsIDApCkRvd25CdXR0b24uVGV4dCA9ICLirIcgVHVydW4iCkRvd25CdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDE3MCwgMjU1KQpEb3duQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSkKRG93bkJ1dHRvbi5UZXh0U2NhbGVkID0gdHJ1ZQpEb3duQnV0dG9uLlBhcmVudCA9IFNjcmVlbkd1aQpEb3duQnV0dG9uLlZpc2libGUgPSBmYWxzZQoKLS0gSW5mbyBQQwpsb2NhbCBJbmZvTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCkluZm9MYWJlbC5TaXplID0gVURpbTIubmV3KDAsIDI2MCwgMCwgNzApCkluZm9MYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjcsIDAsIDAuMDUsIDApCkluZm9MYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4zCkluZm9MYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwwLDApCkluZm9MYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDI1NSwyNTUpCkluZm9MYWJlbC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnNCb2xkCkluZm9MYWJlbC5UZXh0U2l6ZSA9IDE4CkluZm9MYWJlbC5WaXNpYmxlID0gZmFsc2UKSW5mb0xhYmVsLlRleHQgPSAiRmx5IENvbnRyb2xzOlxuV0FTRCA9IEdlcmFrXG5TcGFjZSA9IE5haWtcblNoaWZ0ID0gVHVydW4iCkluZm9MYWJlbC5QYXJlbnQgPSBTY3JlZW5HdWkKCmxvY2FsIHVwUHJlc3NlZCwgZG93blByZXNzZWQgPSBmYWxzZSwgZmFsc2UKVXBCdXR0b24uTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkgdXBQcmVzc2VkID0gdHJ1ZSBlbmQpClVwQnV0dG9uLk1vdXNlQnV0dG9uMVVwOkNvbm5lY3QoZnVuY3Rpb24oKSB1cFByZXNzZWQgPSBmYWxzZSBlbmQpCkRvd25CdXR0b24uTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkgZG93blByZXNzZWQgPSB0cnVlIGVuZCkKRG93bkJ1dHRvbi5Nb3VzZUJ1dHRvbjFVcDpDb25uZWN0KGZ1bmN0aW9uKCkgZG93blByZXNzZWQgPSBmYWxzZSBlbmQpCgotLSBTdGFydCBGbHkKbG9jYWwgZnVuY3Rpb24gc3RhcnRGbHkoKQogICAgaWYgZmx5aW5nIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBocnAgPSBjaGFyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgZmx5aW5nID0gdHJ1ZQoKICAgIC0tIEJvZHlWZWxvY2l0eSB1bnR1ayBkb3Jvbmcga2FyYWt0ZXIKICAgIGZseUJWID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQogICAgZmx5QlYuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldygxZTUsIDFlNSwgMWU1KQogICAgZmx5QlYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLDAsMCkKICAgIGZseUJWLlBhcmVudCA9IGhycAoKICAgIC0tIEJvZHlHeXJvIGJpYXIgbmdpa3V0IGFyYWgga2FtZXJhCiAgICBmbHlHeXJvID0gSW5zdGFuY2UubmV3KCJCb2R5R3lybyIpCiAgICBmbHlHeXJvLk1heFRvcnF1ZSA9IFZlY3RvcjMubmV3KDFlNSwgMWU1LCAxZTUpCiAgICBmbHlHeXJvLkNGcmFtZSA9IGhycC5DRnJhbWUKICAgIGZseUd5cm8uUGFyZW50ID0gaHJwCgogICAgaWYgVXNlcklucHV0U2VydmljZS5Ub3VjaEVuYWJsZWQgdGhlbgogICAgICAgIFVwQnV0dG9uLlZpc2libGUgPSB0cnVlCiAgICAgICAgRG93bkJ1dHRvbi5WaXNpYmxlID0gdHJ1ZQogICAgZWxzZWlmIFVzZXJJbnB1dFNlcnZpY2UuS2V5Ym9hcmRFbmFibGVkIHRoZW4KICAgICAgICBJbmZvTGFiZWwuVmlzaWJsZSA9IHRydWUKICAgIGVuZAoKICAgIGZseUNvbm4gPSBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IGZseWluZyB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBjYW1DRiA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZQogICAgICAgIGxvY2FsIG1vdmVEaXIgPSBWZWN0b3IzLm5ldygpCgogICAgICAgIC0tIFBDCiAgICAgICAgaWYgVXNlcklucHV0U2VydmljZS5LZXlib2FyZEVuYWJsZWQgdGhlbgogICAgICAgICAgICBpZiBVc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuVykgdGhlbgogICAgICAgICAgICAgICAgbW92ZURpciArPSBjYW1DRi5Mb29rVmVjdG9yCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBVc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuUykgdGhlbgogICAgICAgICAgICAgICAgbW92ZURpciAtPSBjYW1DRi5Mb29rVmVjdG9yCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBVc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuQSkgdGhlbgogICAgICAgICAgICAgICAgbW92ZURpciAtPSBjYW1DRi5SaWdodFZlY3RvcgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgVXNlcklucHV0U2VydmljZTpJc0tleURvd24oRW51bS5LZXlDb2RlLkQpIHRoZW4KICAgICAgICAgICAgICAgIG1vdmVEaXIgKz0gY2FtQ0YuUmlnaHRWZWN0b3IKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIFVzZXJJbnB1dFNlcnZpY2U6SXNLZXlEb3duKEVudW0uS2V5Q29kZS5TcGFjZSkgdGhlbgogICAgICAgICAgICAgICAgbW92ZURpciArPSBWZWN0b3IzLm5ldygwLDEsMCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIFVzZXJJbnB1dFNlcnZpY2U6SXNLZXlEb3duKEVudW0uS2V5Q29kZS5MZWZ0U2hpZnQpIHRoZW4KICAgICAgICAgICAgICAgIG1vdmVEaXIgLT0gVmVjdG9yMy5uZXcoMCwxLDApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2VpZiBVc2VySW5wdXRTZXJ2aWNlLlRvdWNoRW5hYmxlZCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGlmIGh1bSB0aGVuCiAgICAgICAgICAgICAgICBtb3ZlRGlyICs9IGh1bS5Nb3ZlRGlyZWN0aW9uCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiB1cFByZXNzZWQgdGhlbgogICAgICAgICAgICAgICAgbW92ZURpciArPSBWZWN0b3IzLm5ldygwLDEsMCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGRvd25QcmVzc2VkIHRoZW4KICAgICAgICAgICAgICAgIG1vdmVEaXIgLT0gVmVjdG9yMy5uZXcoMCwxLDApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBmbHlHeXJvLkNGcmFtZSA9IGNhbUNGCiAgICAgICAgaWYgbW92ZURpci5NYWduaXR1ZGUgPiAwIHRoZW4KICAgICAgICAgICAgZmx5QlYuVmVsb2NpdHkgPSBtb3ZlRGlyLlVuaXQgKiBmbHlTcGVlZAogICAgICAgIGVsc2UKICAgICAgICAgICAgZmx5QlYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLDAsMCkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgotLSBTdG9wIEZseQpsb2NhbCBmdW5jdGlvbiBzdG9wRmx5KCkKICAgIGZseWluZyA9IGZhbHNlCiAgICBpZiBmbHlDb25uIHRoZW4gZmx5Q29ubjpEaXNjb25uZWN0KCkgZmx5Q29ubiA9IG5pbCBlbmQKICAgIGlmIGZseUJWIHRoZW4gZmx5QlY6RGVzdHJveSgpIGZseUJWID0gbmlsIGVuZAogICAgaWYgZmx5R3lybyB0aGVuIGZseUd5cm86RGVzdHJveSgpIGZseUd5cm8gPSBuaWwgZW5kCiAgICBVcEJ1dHRvbi5WaXNpYmxlID0gZmFsc2UKICAgIERvd25CdXR0b24uVmlzaWJsZSA9IGZhbHNlCiAgICBJbmZvTGFiZWwuVmlzaWJsZSA9IGZhbHNlCmVuZAoKLS0gVG9nZ2xlClNldHRpbmdzVGFiOkNyZWF0ZVRvZ2dsZSh7CiAgICBOYW1lID0gIkZseSAoU3RhYmxlKSIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiRmx5VG9nZ2xlU3RhYmxlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBzdGFydEZseSgpCiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG9wRmx5KCkKICAgICAgICBlbmQKICAgIGVuZCwKfSkKCi0tIFNwZWVkIFNsaWRlcgpTZXR0aW5nc1RhYjpDcmVhdGVTbGlkZXIoewogICAgTmFtZSA9ICJGbHkgU3BlZWQiLAogICAgUmFuZ2UgPSB7MTAsIDIwMH0sCiAgICBJbmNyZW1lbnQgPSA1LAogICAgU3VmZml4ID0gIlNwZWVkIiwKICAgIEN1cnJlbnRWYWx1ZSA9IGZseVNwZWVkLAogICAgRmxhZyA9ICJGbHlTcGVlZFNsaWRlclN0YWJsZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGZseVNwZWVkID0gVmFsdWUKICAgIGVuZCwKfSkKCgotLSA9PT09PT09PT09PT09PT09PT09PT09PT0KLS0gU2Vuc29yIE5hbWEgU2F5YSAoQW50aSBLZWRpcCkKLS0gPT09PT09PT09PT09PT09PT09PT09PT09CmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgbHAgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHJhbmRvbUFjdGl2ZSA9IGZhbHNlCmxvY2FsIG5hbWVMb29wID0gbmlsCgpsb2NhbCBmYWtlTmFtZXMgPSB7CiAgICAiT3JhbmdNaXN0ZXJpdXMiLCJQbGF5ZXJYIiwiTm9vYkJlcmdheWEiLCJTaVRlbWJ1cyIsIkhhbnR1R3VudW5nIgp9Cgpsb2NhbCBmdW5jdGlvbiBnZXRSYW5kb21OYW1lKCkKICAgIHJldHVybiBmYWtlTmFtZXNbbWF0aC5yYW5kb20oMSwgI2Zha2VOYW1lcyldCmVuZAoKbG9jYWwgZnVuY3Rpb24gYXBwbHlOb05hbWUoY2hhcikKICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIiwgNSkKICAgIGxvY2FsIGhlYWQgPSBjaGFyOldhaXRGb3JDaGlsZCgiSGVhZCIsIDUpCiAgICBpZiBub3QgaHVtYW5vaWQgb3Igbm90IGhlYWQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0gc2VtYnVueWlrYW4gbGFiZWwgZGVmYXVsdAogICAgaHVtYW5vaWQuTmFtZURpc3BsYXlEaXN0YW5jZSA9IDAKICAgIGh1bWFub2lkLkRpc3BsYXlEaXN0YW5jZVR5cGUgPSBFbnVtLkh1bWFub2lkRGlzcGxheURpc3RhbmNlVHlwZS5Ob25lCiAgICBodW1hbm9pZC5EaXNwbGF5TmFtZSA9ICIiCgogICAgLS0gaGFwdXMgc2VtdWEgQmlsbGJvYXJkIGJhd2FhbgogICAgZm9yIF8sIGd1aSBpbiBpcGFpcnMoaGVhZDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGd1aTpJc0EoIkJpbGxib2FyZEd1aSIpIGFuZCBndWkuTmFtZSB+PSAiRmFrZU5hbWUiIHRoZW4KICAgICAgICAgICAgZ3VpOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gYmlraW4gZmFrZSBuYW1lIHNlbmRpcmkga2FsYXUgYmVsdW0gYWRhCiAgICBpZiBub3QgaGVhZDpGaW5kRmlyc3RDaGlsZCgiRmFrZU5hbWUiKSB0aGVuCiAgICAgICAgbG9jYWwgYmlsbGJvYXJkID0gSW5zdGFuY2UubmV3KCJCaWxsYm9hcmRHdWkiKQogICAgICAgIGJpbGxib2FyZC5OYW1lID0gIkZha2VOYW1lIgogICAgICAgIGJpbGxib2FyZC5BZG9ybmVlID0gaGVhZAogICAgICAgIGJpbGxib2FyZC5TaXplID0gVURpbTIubmV3KDAsIDIwMCwgMCwgNTApCiAgICAgICAgYmlsbGJvYXJkLlN0dWRzT2Zmc2V0ID0gVmVjdG9yMy5uZXcoMCwgMi41LCAwKQogICAgICAgIGJpbGxib2FyZC5BbHdheXNPblRvcCA9IHRydWUKICAgICAgICBiaWxsYm9hcmQuUGFyZW50ID0gaGVhZAoKICAgICAgICBsb2NhbCB0ZXh0ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgICAgIHRleHQuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgICAgIHRleHQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICB0ZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMubmV3KDEsMSwxKQogICAgICAgIHRleHQuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAKICAgICAgICB0ZXh0LkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2Fuc0JvbGQKICAgICAgICB0ZXh0LlRleHRTY2FsZWQgPSB0cnVlCiAgICAgICAgdGV4dC5UZXh0ID0gZ2V0UmFuZG9tTmFtZSgpCiAgICAgICAgdGV4dC5QYXJlbnQgPSBiaWxsYm9hcmQKICAgIGVuZAoKICAgIC0tIGxvb3AgYW50aS1rZWRpcCAoaGFwdXMgbmFtZSB0YWcgYXNsaSBzZXRpYXAgZnJhbWUpCiAgICBpZiBuYW1lTG9vcCB0aGVuIG5hbWVMb29wOkRpc2Nvbm5lY3QoKSBlbmQKICAgIG5hbWVMb29wID0gUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCByYW5kb21BY3RpdmUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgaWYgaGVhZCB0aGVuCiAgICAgICAgICAgIGZvciBfLCBndWkgaW4gaXBhaXJzKGhlYWQ6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgIGlmIGd1aTpJc0EoIkJpbGxib2FyZEd1aSIpIGFuZCBndWkuTmFtZSB+PSAiRmFrZU5hbWUiIHRoZW4KICAgICAgICAgICAgICAgICAgICBndWk6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gcmVzZXROYW1lKGNoYXIpCiAgICBpZiBuYW1lTG9vcCB0aGVuCiAgICAgICAgbmFtZUxvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgbmFtZUxvb3AgPSBuaWwKICAgIGVuZAogICAgbG9jYWwgaGVhZCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKQogICAgaWYgaGVhZCBhbmQgaGVhZDpGaW5kRmlyc3RDaGlsZCgiRmFrZU5hbWUiKSB0aGVuCiAgICAgICAgaGVhZC5GYWtlTmFtZTpEZXN0cm95KCkKICAgIGVuZAogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgaHVtYW5vaWQuRGlzcGxheURpc3RhbmNlVHlwZSA9IEVudW0uSHVtYW5vaWREaXNwbGF5RGlzdGFuY2VUeXBlLlZpZXdlcgogICAgICAgIGh1bWFub2lkLk5hbWVEaXNwbGF5RGlzdGFuY2UgPSAxMDAKICAgICAgICBodW1hbm9pZC5EaXNwbGF5TmFtZSA9IGxwLk5hbWUKICAgIGVuZAplbmQKClNldHRpbmdzVGFiOkNyZWF0ZVRvZ2dsZSh7CiAgIE5hbWUgPSAiU2Vuc29yIE5hbWEiLAogICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgRmxhZyA9ICJNeUZha2VOYW1lVG9nZ2xlIiwKICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICByYW5kb21BY3RpdmUgPSBWYWx1ZQogICAgICAgIGlmIHJhbmRvbUFjdGl2ZSB0aGVuCiAgICAgICAgICAgIGlmIGxwLkNoYXJhY3RlciB0aGVuIGFwcGx5Tm9OYW1lKGxwLkNoYXJhY3RlcikgZW5kCiAgICAgICAgICAgIGxwLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgaWYgcmFuZG9tQWN0aXZlIHRoZW4KICAgICAgICAgICAgICAgICAgICBhcHBseU5vTmFtZShjaGFyKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIGxwLkNoYXJhY3RlciB0aGVuIHJlc2V0TmFtZShscC5DaGFyYWN0ZXIpIGVuZAogICAgICAgIGVuZAogICBlbmQKfSkKCgoKLS0gPT09PT09PT09PT09PT09PT09PT09PT09Ci0tIEZ1blRhYjogRm9sbG93ICsgTGVuZ2FuIEpvZ2V0ICsgS2VwYWxhIFRlcmJhbGlrCi0tID09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgRnVuVGFiID0gV2luZG93OkNyZWF0ZVRhYigiRnVuIiwgNDQ4MzM2MjQ1OCkKRnVuVGFiOkNyZWF0ZVNlY3Rpb24oIlRyb2xsaW5nIikKbG9jYWwgVGFyZ2V0UGxheWVyID0gbmlsCmxvY2FsIEZvbGxvd0Nvbm5lY3Rpb24KbG9jYWwgSm9nZXRDb25uZWN0aW9uCgpsb2NhbCBKb2dldEFtcGxpdHVkZSA9IDMwIC0tIGRlcmFqYXQKbG9jYWwgSm9nZXRTcGVlZCA9IDUgLS0ga2VjZXBhdGFuCgotLSBEcm9wZG93biBwaWxpaCBwbGF5ZXIKbG9jYWwgZnVuY3Rpb24gUmVmcmVzaFBsYXllckxpc3QoKQogICAgbG9jYWwgbmFtZXMgPSB7fQogICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KG5hbWVzLCBwbHIuRGlzcGxheU5hbWUpCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuYW1lcwplbmQKCmxvY2FsIFBsYXllckRyb3Bkb3duID0gRnVuVGFiOkNyZWF0ZURyb3Bkb3duKHsKICAgIE5hbWUgPSAi8J+Sg/Cfj7sgUGlsaWggUGxheWVyIiwKICAgIE9wdGlvbnMgPSBSZWZyZXNoUGxheWVyTGlzdCgpLAogICAgQ3VycmVudE9wdGlvbiA9IHt9LAogICAgRmxhZyA9ICJGdW5QbGF5ZXJEcm9wZG93biIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKG9wdGlvbikKICAgICAgICBmb3IgXywgcGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgaWYgcGxyLkRpc3BsYXlOYW1lID09IG9wdGlvblsxXSB0aGVuCiAgICAgICAgICAgICAgICBUYXJnZXRQbGF5ZXIgPSBwbHIKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpGdW5UYWI6Q3JlYXRlQnV0dG9uKHsKICAgIE5hbWUgPSAi8J+Sg/Cfj7sgUmVmcmVzaCBQbGF5ZXIgTGlzdCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBQbGF5ZXJEcm9wZG93bjpSZWZyZXNoKFJlZnJlc2hQbGF5ZXJMaXN0KCksIHRydWUpCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBGb2xsb3cgUGxheWVyCmxvY2FsIEZvbGxvd0VuYWJsZWQgPSBmYWxzZQpGdW5UYWI6Q3JlYXRlVG9nZ2xlKHsKICAgIE5hbWUgPSAi8J+PgyBJa3V0aSBQbGF5ZXIiLAogICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgICBGbGFnID0gIkZvbGxvd1RvZ2dsZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIEZvbGxvd0VuYWJsZWQgPSB2YWx1ZQogICAgICAgIGlmIEZvbGxvd0VuYWJsZWQgdGhlbgogICAgICAgICAgICBGb2xsb3dDb25uZWN0aW9uID0gUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBUYXJnZXRQbGF5ZXIgYW5kIFRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIFRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KFRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiArIFZlY3RvcjMubmV3KDAsMC41LDApKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIEZvbGxvd0Nvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgRm9sbG93Q29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIEZvbGxvd0Nvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKRnVuVGFiOkNyZWF0ZVNlY3Rpb24oIkVtb3RlIikKbG9jYWwgSm9nZXRFbmFibGVkID0gZmFsc2UKRnVuVGFiOkNyZWF0ZVRvZ2dsZSh7CiAgICBOYW1lID0gIvCfl78gSm9nZXQgY2FjaW5nYW4iLAogICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgICBGbGFnID0gIkpvZ2V0VG9nZ2xlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgSm9nZXRFbmFibGVkID0gdmFsdWUKICAgICAgICBpZiBKb2dldEVuYWJsZWQgdGhlbgogICAgICAgICAgICBsb2NhbCB0ID0gMAogICAgICAgICAgICBKb2dldENvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKGR0KQogICAgICAgICAgICAgICAgdCArPSBkdCAqIEpvZ2V0U3BlZWQKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGlmIGNoYXIgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxlZnRBcm0gPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0VXBwZXJBcm0iKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0IEFybSIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmlnaHRBcm0gPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJSaWdodFVwcGVyQXJtIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHQgQXJtIikKICAgICAgICAgICAgICAgICAgICBpZiBsZWZ0QXJtIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbGVmdEFybS5DRnJhbWUgPSBsZWZ0QXJtLkNGcmFtZSAqIENGcmFtZS5BbmdsZXMoMSwgMCwgbWF0aC5yYWQobWF0aC5zaW4odCkgKiBKb2dldEFtcGxpdHVkZSkpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgcmlnaHRBcm0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByaWdodEFybS5DRnJhbWUgPSByaWdodEFybS5DRnJhbWUgKiBDRnJhbWUuQW5nbGVzKDEsIDAsIG1hdGgucmFkKC1tYXRoLnNpbih0KSAqIEpvZ2V0QW1wbGl0dWRlKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBKb2dldENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgSm9nZXRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgSm9nZXRDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBUb2dnbGUgS2VwYWxhIGRpIGJhd2FoIC8gdGVyYmFsaWsgcGVybWFuZW4KbG9jYWwgSW52ZXJ0RW5hYmxlZCA9IGZhbHNlCmxvY2FsIEludmVydENvbm5lY3Rpb24KCkZ1blRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICLwn5e/IEtlcGFsYSBLZWJhd2FoIiwKICAgIEN1cnJlbnRWYWx1ZSA9IGZhbHNlLAogICAgRmxhZyA9ICJJbnZlcnRUb2dnbGUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBJbnZlcnRFbmFibGVkID0gdmFsdWUKCiAgICAgICAgaWYgSW52ZXJ0RW5hYmxlZCB0aGVuCiAgICAgICAgICAgIGlmIEludmVydENvbm5lY3Rpb24gdGhlbiBJbnZlcnRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKSBlbmQKICAgICAgICAgICAgSW52ZXJ0Q29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgaWYgY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290ID0gY2hhci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICAgICAgLS0gTWVtYXN0aWthbiBzZWxhbHUgdGVyYmFsaWsKICAgICAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcocm9vdC5Qb3NpdGlvbikgKiBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKDE4MCksMTAsMCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBJbnZlcnRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgIEludmVydENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBJbnZlcnRDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAtLSBLZW1iYWxpa2FuIG5vcm1hbAogICAgICAgICAgICBsb2NhbCBjaGFyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCByb290ID0gY2hhci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcocm9vdC5Qb3NpdGlvbikgKiBDRnJhbWUuQW5nbGVzKDAsMCwwKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBscCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgc2l0QWN0aXZlID0gZmFsc2UKbG9jYWwgY29uc3RyYWludCA9IHt9CgotLSBjYXJpIHBsYXllciB0ZXJkZWthdApsb2NhbCBmdW5jdGlvbiBnZXROZWFyZXN0UGxheWVyKCkKICAgIGxvY2FsIG5lYXJlc3QsIGRpc3QgPSBuaWwsIG1hdGguaHVnZQogICAgZm9yIF8sIHBsciBpbiBwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBwbHIgfj0gbHAgYW5kIHBsci5DaGFyYWN0ZXIgYW5kIHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGQgPSAobHAuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSBwbHIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICBpZiBkIDwgZGlzdCB0aGVuCiAgICAgICAgICAgICAgICBkaXN0ID0gZAogICAgICAgICAgICAgICAgbmVhcmVzdCA9IHBscgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIG5lYXJlc3QKZW5kCgotLSBkdWR1ayBkaSBhdGFzIHBsYXllcgpsb2NhbCBmdW5jdGlvbiBzaXRPblBsYXllcih0YXJnZXQpCiAgICBpZiBub3QgdGFyZ2V0IG9yIG5vdCB0YXJnZXQuQ2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgbXlIUlAgPSBscC5DaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGxvY2FsIHRhcmdldEhSUCA9IHRhcmdldC5DaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCiAgICAtLSBiZXJzaWhrYW4gY29uc3RyYWludCBsYW1hCiAgICBmb3IgXywgdiBpbiBwYWlycyhteUhSUDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHY6SXNBKCJBbGlnblBvc2l0aW9uIikgb3IgdjpJc0EoIkFsaWduT3JpZW50YXRpb24iKSBvciB2OklzQSgiQXR0YWNobWVudCIpIHRoZW4KICAgICAgICAgICAgdjpEZXN0cm95KCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGJpa2luIGF0dGFjaG1lbnQKICAgIGxvY2FsIGEwID0gSW5zdGFuY2UubmV3KCJBdHRhY2htZW50IiwgbXlIUlApCiAgICBsb2NhbCBhMSA9IEluc3RhbmNlLm5ldygiQXR0YWNobWVudCIsIHRhcmdldEhSUCkKICAgIGEwLlBvc2l0aW9uID0gVmVjdG9yMy5uZXcoMCwgMiwgMCkgLS0gZHVkdWsgZGkgYXRhcyBrZXBhbGEKCiAgICBsb2NhbCBhcCA9IEluc3RhbmNlLm5ldygiQWxpZ25Qb3NpdGlvbiIsIG15SFJQKQogICAgYXAuTWF4Rm9yY2UgPSA5OTk5OTkKICAgIGFwLlJlc3BvbnNpdmVuZXNzID0gMjAwCiAgICBhcC5BdHRhY2htZW50MCA9IGEwCiAgICBhcC5BdHRhY2htZW50MSA9IGExCgogICAgbG9jYWwgYW8gPSBJbnN0YW5jZS5uZXcoIkFsaWduT3JpZW50YXRpb24iLCBteUhSUCkKICAgIGFvLk1heFRvcnF1ZSA9IDk5OTk5OQogICAgYW8uUmVzcG9uc2l2ZW5lc3MgPSAyMDAKICAgIGFvLkF0dGFjaG1lbnQwID0gYTAKICAgIGFvLkF0dGFjaG1lbnQxID0gYTEKCiAgICBjb25zdHJhaW50ID0ge2FwLCBhbywgYTAsIGExfQplbmQKCi0tIGxlcGFzIGR1ZHVrCmxvY2FsIGZ1bmN0aW9uIHVuU2l0KCkKICAgIGlmIGxwLkNoYXJhY3RlciBhbmQgbHAuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGxwLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHY6SXNBKCJBbGlnblBvc2l0aW9uIikgb3IgdjpJc0EoIkFsaWduT3JpZW50YXRpb24iKSBvciB2OklzQSgiQXR0YWNobWVudCIpIHRoZW4KICAgICAgICAgICAgICAgIHY6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICBjb25zdHJhaW50ID0ge30KZW5kCgotLSDinIUgVGFtYmFoa2FuIGtlIFJheWZpZWxkIChtaXNhbG55YSBkaSBGdW5UYWIpCkZ1blRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICJEdWR1ayBkaSBQbGF5ZXIgVGVyZGVrYXQiLAogICAgQ3VycmVudFZhbHVlID0gZmFsc2UsCiAgICBGbGFnID0gIlNpdE9uUGxheWVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgc2l0QWN0aXZlID0gVmFsdWUKICAgICAgICBpZiBzaXRBY3RpdmUgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBnZXROZWFyZXN0UGxheWVyKCkKICAgICAgICAgICAgaWYgdGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgIHNpdE9uUGxheWVyKHRhcmdldCkKICAgICAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQWt0aWYiLAogICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSAia2VwbGF5ZXIgIiAuLiB0YXJnZXQuTmFtZSwKICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiVGlkYWsgQWRhIFRhcmdldCIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJUaWRhayBhZGEgcGxheWVyIHRlcmRla2F0LiIsCiAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIHVuU2l0KCkKICAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIk5vbmFrdGlmIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiS2FtdSB0dXJ1biBkYXJpIHBsYXllci4iLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQsCn0pCgotLSBUb2dnbGUgQXV0by1CeXBhc3MgQ1AKbG9jYWwgQXV0b0J5cGFzc1RvZ2dsZSA9IEZ1blRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIEJ5cGFzcyBDUCIsCiAgICBDdXJyZW50VmFsdWUgPSBmYWxzZSwKICAgIEZsYWcgPSAiQXV0b0J5cGFzcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIC0tIHRvZ2dsZSBvdG9tYXRpcyBha2FuIHRlcnNlZGlhIGRpIEZ1blRhYi5GbGFncy5BdXRvQnlwYXNzCiAgICBlbmQKfSkKCi0tIERhZnRhciBDUCB5YW5nIGluZ2luIGRpLWJ5cGFzcwpsb2NhbCBDUEluZGV4ZXMgPSB7MiwzLDQsNX0KCi0tIExvb3AgdW50dWsgYXV0byBieXBhc3MKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgRnVuVGFiLkZsYWdzLkF1dG9CeXBhc3MgdGhlbgogICAgICAgICAgICBmb3IgXywgaW5kZXggaW4gcGFpcnMoQ1BJbmRleGVzKSBkbwogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGlmIENQRXZlbnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBDUEV2ZW50OkZpcmVTZXJ2ZXIoaW5kZXgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgxKQogICAgZW5kCmVuZCk=
]]
local decoded = game:GetService("HttpService"):Base64Decode(code)
loadstring(decoded)()
